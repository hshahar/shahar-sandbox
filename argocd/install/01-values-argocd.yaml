# ArgoCD Helm Values
# Installs ArgoCD with ingress and RBAC configuration

server:
  ingress:
    enabled: true
    ingressClassName: nginx
    annotations:
      cert-manager.io/cluster-issuer: letsencrypt-prod   # if you use cert-manager
      nginx.ingress.kubernetes.io/ssl-passthrough: "false"
      nginx.ingress.kubernetes.io/backend-protocol: "HTTP"
    hosts:
      - sha-argocd.blog.local  # Replace with your domain
    tls:
      - hosts:
          - sha-argocd.blog.local
        secretName: argocd-tls

# Run Argo CD server behind TLS-terminating ingress (backend HTTP)
configs:
  params:
    server.insecure: "true"

  cm:
    admin.enabled: "true"
    application.instanceLabelKey: argocd.argoproj.io/instance

    # Example OIDC (Azure AD). Remove if not needed.
    # oidc.config: |
    #   name: AzureAD
    #   issuer: https://login.microsoftonline.com/YOUR_TENANT_ID/v2.0
    #   clientID: YOUR_AZUREAD_APP_CLIENT_ID
    #   clientSecret: $oidc.azuread.clientSecret
    #   requestedScopes:
    #   - openid
    #   - profile
    #   - email
    #   - groups

  rbac:
    policy.default: role:readonly
    # Uncomment and configure for your IdP
    # policy.csv: |
    #   # Give full admin to your IdP admin group/object
    #   g, YOUR_IDP_ADMINS_GROUP_ID, role:admin
    #   # Optional viewers group
    #   g, YOUR_IDP_VIEWERS_GROUP_ID, role:readonly
    # scopes: "[groups]"

  # Repository credentials (creates k8s Secrets for Argo CD)
  credentialTemplates:
    gh-org-template:
      url: https://github.com/hshahar
      username: hshahar
      password: ""  # Replace with GitHub Personal Access Token

  repositories:
    sha-blog-git:
      type: git
      url: https://github.com/hshahar/Sumit-shaharH-test.git
      username: hshahar
      password: ""  # Replace with GitHub Personal Access Token

  # Secrets referenced above (e.g., OIDC secret)
  secret:
    createSecret: true
    # Uncomment if using OIDC
    # extra:
    #   oidc.azuread.clientSecret: "REPLACE_WITH_REAL_SECRET"

# Resource limits for ArgoCD components
controller:
  resources:
    requests:
      cpu: 500m
      memory: 512Mi
    limits:
      cpu: 1000m
      memory: 1Gi

server:
  resources:
    requests:
      cpu: 250m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi

repoServer:
  resources:
    requests:
      cpu: 250m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi
